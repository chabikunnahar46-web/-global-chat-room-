<!DOCTYPE html>
<html>
<head>
  <title>Your Profile</title>
  <style>
    body{text-align:center;font-family:Arial;background:#eef2f5;}
    .card{
      width:300px;background:white;margin:auto;margin-top:50px;padding:20px;
      border-radius:10px;box-shadow:0 0 10px #ccc;
    }
    img{
      width:120px;height:120px;border-radius:50%;
      border:3px solid #0084ff;
    }
    input{
      width:90%;padding:10px;margin-top:10px;border:1px solid #ddd;border-radius:5px;
    }
    button{
      padding:10px 20px;background:#0084ff;color:white;border:none;border-radius:5px;margin-top:10px;
    }
  </style>
</head>

<body>

  <div class="card">
    <img id="photo">
    <h2 id="name"></h2>
    <p id="email"></p>

    <input id="newName" placeholder="Change Name">
    <input id="newPhoto" placeholder="Change Photo URL">
    <button onclick="updateProfile()">Update</button>
  </div>


  <script type="module">
    import { auth, db } from "./firebase.js";
    import { onAuthStateChanged } 
    from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
    import { doc, getDoc, updateDoc } 
    from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

    onAuthStateChanged(auth, async (user)=>{
      if(!user) return location.href="index.html";

      let snap = await getDoc(doc(db,"users",user.uid));
      let data = snap.data();

      name.innerText = data.name;
      email.innerText = data.email;
      photo.src = data.photo;
    });

    async function updateProfile(){
      let user = auth.currentUser;
      await updateDoc(doc(db,"users",user.uid),{
        name: newName.value,
        photo: newPhoto.value
      });
      location.reload();
    }
  </script>

</body>
</html>
