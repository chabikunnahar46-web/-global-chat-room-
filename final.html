<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile Page</title>
<link rel="stylesheet" href="profile.css">
</head>
<body>
<div class="cover-photo" id="coverPhoto"></div>

<div class="profile-container">
    <div class="pentagon" id="profilePic"></div>
    <h2 id="pName">Name: </h2>
    <p id="pAge">Age: </p>
    <p id="pGF">Girlfriend: </p>
    <p id="pBalance">Bank Balance: </p>
    <p id="pWork">Work: </p>
    <p id="pSchool">School: </p>

    <button onclick="editProfile()">Edit Profile</button>
</div>

<script type="module">
import { database } from './firebase.js';
import { ref, onValue, update } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

// ইউজারের আইডি ধরে রাখো (localStorage বা login system থেকে)
const userId = localStorage.getItem('userId') || "guest";

// ডাটাবেস রেফারেন্স
const userRef = ref(database, 'profiles/' + userId);

// ডাটাবেস থেকে ডাইনামিকভাবে তথ্য লোড করা
onValue(userRef, (snapshot) => {
    const data = snapshot.val();
    if(!data) return;

    document.getElementById("pName").innerText = "Name: " + data.name + " " + (data.surname || "");
    document.getElementById("pAge").innerText = "Age: " + data.dob;
    document.getElementById("pGF").innerText = data.age <= 24 ? "Girlfriend: " + (data.girlfriend || "None") : "";
    document.getElementById("pBalance").innerText = data.age >= 25 ? "Bank Balance: " + (data.balance || "0") : "";
    document.getElementById("pWork").innerText = "Work: " + (data.work || "Not set");
    document.getElementById("pSchool").innerText = "School: " + (data.school || "Not set");

    document.getElementById("profilePic").style.backgroundImage = `url(${data.profile || 'https://i.postimg.cc/02Qmwvhd/avatar.png'})`;
    document.getElementById("coverPhoto").style.backgroundImage = `url(${data.cover || 'https://i.postimg.cc/Z5NmHw1F/cover.jpg'})`;
});

// Edit Profile ফাংশন
function editProfile() {
    const newName = prompt("Enter Name:", document.getElementById("pName").innerText.split(": ")[1]);
    const newWork = prompt("Enter Work:", document.getElementById("pWork").innerText.split(": ")[1]);
    const newSchool = prompt("Enter School:", document.getElementById("pSchool").innerText.split(": ")[1]);

    update(userRef, {
        name: newName,
        work: newWork,
        school: newSchool
    });
}
</script>
</body>
    </html>
